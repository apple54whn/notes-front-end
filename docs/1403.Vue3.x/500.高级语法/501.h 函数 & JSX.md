---
title: h å‡½æ•° & JSX
date: 2022-02-04 19:15:00
permalink: /pages/2b61b7/
categories:
  - x
  - Composition Api
tags:
  - 
---

# h å‡½æ•° & JSX

## h å‡½æ•° ğŸ”¥

### ä»‹ç»

è¿”å›ä¸€ä¸ªâ€è™šæ‹ŸèŠ‚ç‚¹â€œï¼Œé€šå¸¸ç¼©å†™ä¸º **VNode**ï¼šä¸€ä¸ªæ™®é€šå¯¹è±¡ï¼Œå…¶ä¸­åŒ…å«å‘ Vue æè¿°å®ƒåº”åœ¨é¡µé¢ä¸Šæ¸²æŸ“å“ªç§èŠ‚ç‚¹çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ‰€æœ‰å­èŠ‚ç‚¹çš„æè¿°ã€‚å®ƒçš„ç›®çš„æ˜¯ç”¨äºæ‰‹åŠ¨ç¼–å†™çš„[æ¸²æŸ“å‡½æ•°](https://v3.cn.vuejs.org/guide/render-function.html)ï¼š

Vueæ¨èåœ¨ç»å¤§æ•°æƒ…å†µä¸‹**ä½¿ç”¨æ¨¡æ¿**æ¥åˆ›å»ºä½ çš„HTMLï¼Œç„¶åä¸€äº›ç‰¹æ®Šçš„åœºæ™¯ï¼Œä½ çœŸçš„éœ€è¦**JavaScriptçš„å®Œå…¨ç¼–ç¨‹çš„èƒ½åŠ›**ï¼Œè¿™ä¸ªæ—¶å€™ä½ å¯ä»¥ä½¿ç”¨ **h æ¸²æŸ“å‡½æ•°** ï¼Œå®ƒ**æ¯”æ¨¡æ¿æ›´æ¥è¿‘ç¼–è¯‘å™¨**;

* å‰é¢æˆ‘ä»¬è®²è§£è¿‡**VNode**å’Œ**VDOM**çš„æ”¹å˜ï¼šVueåœ¨ç”ŸæˆçœŸå®çš„DOMä¹‹å‰ï¼Œä¼šå°†æˆ‘ä»¬çš„èŠ‚ç‚¹è½¬æ¢æˆ**VNode**ï¼Œè€ŒVNodeç»„åˆåœ¨ä¸€èµ·å½¢æˆä¸€é¢—æ ‘ç»“æ„ï¼Œå°±æ˜¯è™šæ‹ŸDOM(**VDOM**);

* äº‹å®ä¸Šï¼Œæˆ‘ä»¬ä¹‹å‰ç¼–å†™çš„ template ä¸­çš„HTML æœ€ç»ˆä¹Ÿæ˜¯ä½¿ç”¨**æ¸²æŸ“å‡½æ•°**ç”Ÿæˆå¯¹åº”çš„**VNode**; 
* é‚£ä¹ˆï¼Œå¦‚æœä½ æƒ³å……åˆ†çš„åˆ©ç”¨JavaScriptçš„ç¼–ç¨‹èƒ½åŠ›ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå·±æ¥ç¼–å†™ **createVNode** å‡½æ•°ï¼Œç”Ÿæˆå¯¹åº”çš„**VNode**;

é‚£ä¹ˆæˆ‘ä»¬åº”è¯¥æ€ä¹ˆæ¥åšå‘¢?**ä½¿ç”¨ h()å‡½æ•°**:

* **h()** å‡½æ•°æ˜¯ä¸€ä¸ªç”¨äºåˆ›å»º **VNode** çš„ä¸€ä¸ªå‡½æ•°;
* å…¶å®æ›´å‡†å¤‡çš„å‘½åæ˜¯ **createVNode()** å‡½æ•°ï¼Œä½†æ˜¯ä¸ºäº†ç®€ä¾¿åœ¨Vueå°†ä¹‹ç®€åŒ–ä¸º **h()** å‡½æ•°;

```js
render() {
  return h('h1', {}, 'Some title')
}
```



### å‚æ•° ğŸ”¥

æ¥æ”¶ä¸‰ä¸ªå‚æ•°ï¼š`type`ï¼Œ`props` å’Œ `children`

#### type

- **ç±»å‹ï¼š**`String | Object | Function`

- **è¯¦ç»†ï¼š**

  HTML æ ‡ç­¾åã€ç»„ä»¶ã€å¼‚æ­¥ç»„ä»¶æˆ–å‡½æ•°å¼ç»„ä»¶ã€‚ä½¿ç”¨è¿”å› null çš„å‡½æ•°å°†æ¸²æŸ“ä¸€ä¸ªæ³¨é‡Šã€‚æ­¤å‚æ•°æ˜¯å¿…éœ€çš„ã€‚

#### props

- **ç±»å‹ï¼š**`Object`

- **è¯¦ç»†ï¼š**

  ä¸€ä¸ªå¯¹è±¡ï¼Œä¸æˆ‘ä»¬å°†åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨çš„ attributeã€prop å’Œäº‹ä»¶ç›¸å¯¹åº”ã€‚å¯é€‰ã€‚

#### children

- **ç±»å‹ï¼š**`String | Array | Object`

- **è¯¦ç»†ï¼š**

  å­ä»£ VNodeï¼Œä½¿ç”¨ `h()` ç”Ÿæˆï¼Œæˆ–è€…ä½¿ç”¨å­—ç¬¦ä¸²æ¥è·å–â€œæ–‡æœ¬ VNodeâ€ï¼Œæˆ–å¸¦æœ‰æ’æ§½çš„å¯¹è±¡ã€‚å¯é€‰ã€‚

  ```js
  h('div', {}, [
    'Some text comes first.',
    h('h1', 'A headline'),
    h(MyComponent, {
      someProp: 'foobar'
    })
  ])
  ```



### h å‡½æ•°çš„åŸºæœ¬ä½¿ç”¨

**hå‡½æ•°å¯ä»¥åœ¨ä¸¤ä¸ªåœ°æ–¹ä½¿ç”¨**:

* renderå‡½æ•°é€‰é¡¹ä¸­;

  ```vue
  <script>
    import { h } from 'vue';
  
    export default {
      render() {
        return h("h2", {class: "title"}, "Hello Render")
      }
    }
  </script>
  ```

* setupå‡½æ•°é€‰é¡¹ä¸­(setupæœ¬èº«éœ€è¦æ˜¯ä¸€ä¸ªå‡½æ•°ç±»å‹ï¼Œå‡½æ•°å†è¿”å›hå‡½æ•°åˆ›å»ºçš„VNode);

  ```vue
  <script>
    import { h } from 'vue';
  
    export default {
      setup() {
        return () => h("h2", {class: "title"}, "Hello Render")
      }
    }
  </script>
  ```

  



### render å‡½æ•°å®ç°è®¡æ•°å™¨

```vue
<script>
  import { h } from 'vue';

  export default {
    data() {
      return {
        counter: 0
      }
    },
    render() {
      return h("div", {class: "app"}, [
        h("h2", null, `å½“å‰è®¡æ•°: ${this.counter}`),
        h("button", {
          onClick: () => this.counter++
        }, "+1"),
        h("button", {
          onClick: () => this.counter--
        }, "-1"),
      ])
    }
  }
</script>
```

å¤ªéº»çƒ¦äº†ï¼Œå¯ä»¥ä½¿ç”¨JSXæ›¿ä»£ã€‚





### setup å‡½æ•°å®ç°è®¡æ•°å™¨

```vue
<script>
  import { ref, h } from 'vue';

  export default {
    setup() {
      const counter = ref(0);
      
      return () => {
        return h("div", {class: "app"}, [
          h("h2", null, `å½“å‰è®¡æ•°: ${counter.value}`),
          h("button", {
            onClick: () => counter.value++
          }, "+1"),
          h("button", {
            onClick: () => counter.value--
          }, "-1"),
        ])
      }
    }
  }
</script>
```



### ç»„ä»¶å’Œæ’æ§½çš„ä½¿ç”¨

App.vue

```vue
<script>
import { h } from 'vue'
import HelloWorld from './HelloWorld.vue'

export default {
  render() {
    return h('div', null, [
      h(HelloWorld, null, {
        // default æ’æ§½ï¼›ä½œç”¨åŸŸæ’æ§½
        default: (props) =>
          h('span', null, `appä¼ å…¥åˆ°HelloWorldä¸­çš„å†…å®¹: ${props.name}`),
      }),
    ])
  },
}
</script>

<style scoped></style>
```

HelloWorld.vue

```vue
<script>
import { h } from 'vue'

export default {
  render() {
    return h('div', null, [
      h('h2', null, 'Hello World'),
      // default æ’æ§½ï¼›
      this.$slots.default
        ? this.$slots.default({ name: 'coderwhy' })
        : h('span', null, 'æˆ‘æ˜¯HelloWorldçš„æ’æ§½é»˜è®¤å€¼'),
    ])
  },
}
</script>

<style lang="scss" scoped></style>

```





## JSX ğŸ”¥

### å…¥é—¨

å¦‚æœæˆ‘ä»¬å¸Œæœ›**åœ¨é¡¹ç›®ä¸­ä½¿ç”¨jsx**ï¼Œé‚£ä¹ˆæˆ‘ä»¬**éœ€è¦æ·»åŠ å¯¹jsxçš„æ”¯æŒ**:

* jsxæˆ‘ä»¬é€šå¸¸ä¼šé€šè¿‡Babelæ¥è¿›è¡Œè½¬æ¢ï¼ˆReactç¼–å†™çš„jsxå°±æ˜¯é€šè¿‡babelè½¬æ¢çš„ï¼‰; 
* å¯¹äºVueæ¥è¯´ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨Babelä¸­é…ç½®å¯¹åº”çš„æ’ä»¶å³å¯ï¼ˆå½“å‰ç‰ˆæœ¬æ— éœ€é…ç½®ï¼‰; 

ï¼ˆæ ¹æ®æ˜¯å¦éœ€è¦é…ç½®ï¼‰å®‰è£…**Babelæ”¯æŒVueçš„jsxæ’ä»¶**ï¼š

```bash
 npm install @vue/babel-plugin-jsx -D
```

ï¼ˆæ ¹æ®æ˜¯å¦éœ€è¦é…ç½®ï¼‰åœ¨**babel.config.jsé…ç½®æ–‡ä»¶**ä¸­é…ç½®æ’ä»¶

```js
module.exports = {
  presets: [
    '@vue/cli-plugin-babel/preset'
  ]
}

```



### JSX è®¡æ•°å™¨æ¡ˆä¾‹

App.vue

```vue
<script>
  import HelloWorld from './HelloWorld.vue';

  export default {
    data() {
      return {
        counter: 0
      }
    },

    render() {
      const increment = () => this.counter++;
      const decrement = () => this.counter--;

      return (
        <div>
          <h2>å½“å‰è®¡æ•°: {this.counter}</h2>
          <button onClick={increment}>+1</button>
          <button onClick={decrement}>-1</button>
          <HelloWorld>
          </HelloWorld>
        </div>
      )
    }
  }
</script>

<style lang="scss" scoped>

</style>
```

HelloWorld.vue

```vue
<script>
  export default {
    render() {
      return (
        <div>
          <h2>HelloWorld</h2>
          {this.$slots.default ? this.$slots.default(): <span>å“ˆå“ˆå“ˆ</span>}
        </div>
      )
    }
  }
</script>

<style scoped>

</style>
```











