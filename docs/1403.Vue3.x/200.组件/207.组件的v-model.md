---
title: ç»„ä»¶çš„v-model
date: 2022-01-31 02:12:05
permalink: /pages/fcbaec/
categories:
  - x
  - ç»„ä»¶
tags:
  - 
---

# ç»„ä»¶çš„v-model ğŸ”¥

## æ¨è ğŸ”¥

* åªæ¨èç»‘å®šå•ä¸ªå€¼ï¼
* ç»‘å®šå¯¹è±¡æ¨èè‡ªå·±å†™ï¼



## ä½¿ç”¨ ğŸ”¥

å‰é¢æˆ‘ä»¬åœ¨inputä¸­å¯ä»¥ä½¿ç”¨v-modelæ¥å®ŒæˆåŒå‘ç»‘å®šï¼Œè¿™ä¸ªæ—¶å€™å¾€å¾€ä¼šéå¸¸æ–¹ä¾¿ï¼Œå› ä¸ºv-modelé»˜è®¤å¸®åŠ©æˆ‘ä»¬å®Œæˆäº†ä¸¤ä»¶äº‹ï¼š

* v-bind:valueçš„æ•°æ®ç»‘å®š
* @inputçš„äº‹ä»¶ç›‘å¬

```html
<input v-model="message">
<input :value="message" @input="message = $event.target.value">
```

å¦‚æœæˆ‘ä»¬ç°åœ¨**å°è£…äº†ä¸€ä¸ªç»„ä»¶**ï¼Œå…¶ä»–åœ°æ–¹åœ¨ä½¿ç”¨è¿™ä¸ªç»„ä»¶æ—¶ï¼Œæ˜¯å¦ä¹Ÿå¯ä»¥**ä½¿ç”¨v-modelæ¥åŒæ—¶å®Œæˆè¿™ä¸¤ä¸ªåŠŸèƒ½**å‘¢? ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œvueä¹Ÿæ”¯æŒåœ¨ç»„ä»¶ä¸Šä½¿ç”¨v-modelã€‚ç±»ä¼¼Vue2çš„.sync

**å½“æˆ‘ä»¬åœ¨ç»„ä»¶ä¸Šä½¿ç”¨çš„æ—¶å€™ï¼Œç­‰ä»·äºå¦‚ä¸‹çš„æ“ä½œ**ï¼š

```vue
<template>
    <!-- ç»„ä»¶ä¸Šä½¿ç”¨v-model -->
    <hy-input v-model="message"></hy-input>
    <!-- ç­‰ä»·äºå¦‚ä¸‹ -->
	<hy-input :modelValue="message" @update:model-value="message = $event"></hy-input>

    <h2>{{ message }}</h2>
</template>

<script>
    import HyInput from './HyInput.vue'

    export default {
        components: {
            HyInput,
        },
        data() {
            return {
                message: 'Hello World',
            }
        },
    }
</script>
```

æ‰€ä»¥ hy-input ç»„ä»¶ä¸­ä¹Ÿåº”è¯¥æä¾› modelValue prop å’Œ update:model-value emit

```vue
<template>
  <div>
    <!-- 1.é»˜è®¤ç»‘å®šå’Œäº‹ä»¶å¤„ç†ã€‚äº‹ä»¶è¿˜å¾—buttonè§¦å‘ï¼Œä¸ä¼˜é›… -->
    <!-- <button @click="btnClick">hyinputæŒ‰é’®</button>
    <h2>HyInputçš„message: {{modelValue}}</h2> -->

    <!-- 2.é€šè¿‡inputï¼Œä¹Ÿä¸æ˜¯å¾ˆä¼˜é›… -->
    <!-- <input :value="modelValue" @input="btnClick"> -->

    <!-- 3.ç»‘å®šåˆ°propsä¸­æ˜¯ä¸å¯¹çš„ï¼Œå•å‘æ•°æ®æµï¼Œä¸åº”è¯¥ä¿®æ”¹propsä¸­çš„å€¼ -->
    <!-- <input v-model="modelValue"> -->

    <!-- 4.åˆ©ç”¨è®¡ç®—å±æ€§ï¼ï¼ï¼æ¨èï¼ï¼ï¼-->
    <input v-model="value">

  </div>
</template>

<script>
  export default {
    props: {
      modelValue: String
    },
    emits: ["update:modelValue"],
    computed: {
      value: {
        set(value) {
          this.$emit("update:modelValue", value);
        },
        get() {
          return this.modelValue;
        }
      }
    },
    methods: {
      btnClick(event) {
        this.$emit("update:modelValue", event.target.value);
      }
    }
  }
</script>
```





## ç»‘å®šå¤šä¸ªå€¼ ğŸ”¥

```vue
<template>
	<!-- ç»‘å®šä¸¤ä¸ªv-modelï¼Œæ›´å¤šçš„ä¸€æ ·ï¼ -->
    <hy-input v-model="message" v-model:title="title"></hy-input>

    <h2>{{ message }}</h2>
    <h2>{{ title }}</h2>
</template>

<script>
    import HyInput from './HyInput.vue'

    export default {
        components: {
            HyInput,
        },
        data() {
            return {
                message: 'Hello World',
                title: 'å“ˆå“ˆå“ˆ',
            }
        },
    }
</script>
```

```vue
<template>
  <div>
    <input v-model="value">
    <input v-model="titleData">
  </div>
</template>

<script>
  export default {
    props: {
      modelValue: String,
      title: String 
    },
    emits: ["update:modelValue", "update:title"],
    computed: {
      value: {
        set(value) {
          this.$emit("update:modelValue", value);
        },
        get() {
          return this.modelValue;
        }
      },
      titleData: {
        set(title) {
          this.$emit("update:title", title);
        },
        get() {
          return this.title;
        }
      }
    }
  }
</script>
```



## æ³¨æ„â€”ç»‘å®šå¯¹è±¡ ğŸ”¥

ä¸Šè¿°åªèƒ½ç»‘å®š1ä¸ªå€¼ï¼Œä¸èƒ½ç»‘å®šå¯¹è±¡ï¼å¦åˆ™å¯¹è±¡å±æ€§æ”¹å˜ä¸èƒ½è§¦å‘setæ–¹æ³•ã€‚è¯¦ç»†è§é¡¹ç›®ï¼



æ”¹æˆä¸‹é¢ç»‘å®šå¯¹è±¡å†™æ³•è¿˜æ˜¯æœ‰é—®é¢˜ï¼Œè§£å†³æ–¹å¼ï¼š



### æ–¹å¼ä¸€

ç›´æ¥ä¿®æ”¹çˆ¶ç»„ä»¶formDataï¼Œä½†æ˜¯æµ…æ‹·è´é‡Œå¯¹è±¡çš„ä¿®æ”¹ä¸ä¼šè§¦å‘

å¯ä»¥åœ¨çˆ¶ç»„ä»¶ä¸­**ä¸ç›´æ¥ä¿®æ”¹**propsçš„formDataï¼Œè€Œæ˜¯**ä¿®æ”¹formDataä¸­çš„å±æ€§**ï¼

```js
// çˆ¶ç»„ä»¶ä¿®æ”¹å±æ€§ formData.value.xxx = xxx

// å­ç»„ä»¶
const formData = ref({...props.modelValue})
watch(
    formData,
    (newValue) => {
        console.log(newValue)
        emit('update:modelValue', newValue)
    },
    {
        deep: true
    }
)
```

ä¸èƒ½ä½¿ç”¨computedæ¥æ›¿ä»£refï¼Œé…åˆwatchä¼šäº§ç”Ÿ**æ— é™é€’å½’**ï¼

### æ–¹å¼äºŒ

ä¸é€‚ç”¨v-modelåŒå‘ç»‘å®šè¯­æ³•ç³–ï¼Œè€Œæ˜¯è‡ªå®šä¹‰ï¼

å­ç»„ä»¶

```vue
<template>
	<el-input
          :model-value="modelValue[`${item.field}`]"
          @update:modelValue="handleValueChange($event, item.field)"
          />
</template>

<script lang="ts" setup >
    const props = defineProps({
        modelValue: {
            type: Object,
            required: true,
        }
    })
    
    const emit = defineEmits(['update:modelValue'])
    
    const handleValueChange = (value: any, field: string) => {
      emit('update:modelValue', { ...props.modelValue, [field]: value })
    }
</script>
```

çˆ¶ç»„ä»¶ç›´æ¥ä¿®æ”¹ formData.value éƒ½å¯ä»¥ï¼

