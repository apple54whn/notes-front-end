---
title: TSä¸“å±æ•°æ®ç±»å‹&ä½¿ç”¨
date: 2022-03-25 00:16:08
permalink: /pages/1322e7/
categories:
  - TS
tags:
  - 
---

# TS ä¸“å±æ•°æ®ç±»å‹&ä½¿ç”¨

## anyç±»å‹çš„ä½¿ç”¨

```ts
// å½“è¿›è¡Œä¸€äº›ç±»å‹æ–­è¨€ as any
// åœ¨ä¸æƒ³ç»™æŸäº›JavaScriptæ·»åŠ å…·ä½“çš„æ•°æ®ç±»å‹æ—¶(åŸç”Ÿçš„JavaScriptä»£ç æ˜¯ä¸€æ ·)
let message: any = "Hello World"

message = 123
message = true
message = {

}

// message()
// message.split(" ")

console.log(message)
const arr: any[] = []
```





## unknownç±»å‹çš„ä½¿ç”¨

```ts
function foo() {
  return "abc"
}

function bar() {
  return 123
}

// unknownç±»å‹åªèƒ½èµ‹å€¼ç»™anyå’Œunknownç±»å‹
// anyç±»å‹å¯ä»¥èµ‹å€¼ç»™ä»»æ„ç±»å‹

let flag = true
let result: unknown // æœ€å¥½ä¸è¦ä½¿ç”¨any
if (flag) {
  result = foo()
} else {
  result = bar()
}

let message: string = result
let num: number = result

console.log(result)

export {}
```



## voidç±»å‹çš„ä½¿ç”¨

```ts
function sum(num1: number, num2: number) {
  console.log(num1 + num2)
}

sum(20, 30)
// sum("abc", "cba")
```



## neverç±»å‹çš„ä½¿ç”¨

never è¡¨ç¤ºæ°¸è¿œä¸ä¼šå‘ç”Ÿå€¼çš„ç±»å‹ï¼Œæ¯”å¦‚ä¸€ä¸ªå‡½æ•°:

å¦‚æœä¸€ä¸ªå‡½æ•°ä¸­æ˜¯ä¸€ä¸ª**æ­»å¾ªç¯**æˆ–è€…**æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸**ï¼Œé‚£ä¹ˆè¿™ä¸ªå‡½æ•°ä¼šè¿”å›ä¸œè¥¿å—?ä¸ä¼šï¼Œé‚£ä¹ˆå†™voidç±»å‹æˆ–è€…å…¶ä»–ç±»å‹ä½œä¸ºè¿”å›å€¼ç±»å‹éƒ½ä¸åˆé€‚ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨neverç±»å‹;

```ts
// function foo(): never {
//   // æ­»å¾ªç¯
//   while(true) {

//   }
// }

// function bar(): never {
//   throw new Error()
// }

// æå‰
// å°è£…ä¸€ä¸ªæ ¸å¿ƒå‡½æ•°
function handleMessage(message: string | number | boolean) {
  switch (typeof message) {
    case 'string':
      console.log('stringå¤„ç†æ–¹å¼å¤„ç†message')
      break
    case 'number':
      console.log('numberå¤„ç†æ–¹å¼å¤„ç†message')
      break
    // case 'boolean':
    //   console.log('booleanå¤„ç†æ–¹å¼å¤„ç†message')
    //   break
    default:
      const check: never = message // ä»…ä»…ä½œä¸ºç¼–è¯‘æ—¶é”™è¯¯æç¤º
  }
}

handleMessage('abc')
handleMessage(123)

// å¼ ä¸‰
handleMessage(true)
```





## tupleâ€”å…ƒç»„ç±»å‹

å¯ä»¥å­˜æ”¾**ä¸åŒç±»å‹**çš„æ•°ç»„ï¼ˆç±»ä¼¼ï¼‰

tupleå’Œæ•°ç»„æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢?

* é¦–å…ˆï¼Œæ•°ç»„ä¸­é€šå¸¸å»ºè®®å­˜æ”¾ç›¸åŒç±»å‹çš„å…ƒç´ ï¼Œä¸åŒç±»å‹çš„å…ƒç´ æ˜¯ä¸æ¨èæ”¾åœ¨æ•°ç»„ä¸­ã€‚(å¯ä»¥æ”¾åœ¨å¯¹è±¡æˆ–è€…å…ƒç»„ä¸­)
* å…¶æ¬¡ï¼Œå…ƒç»„ä¸­æ¯ä¸ªå…ƒç´ éƒ½æœ‰è‡ªå·±ç‰¹æ€§çš„ç±»å‹ï¼Œæ ¹æ®ç´¢å¼•å€¼è·å–åˆ°çš„å€¼å¯ä»¥ç¡®å®šå¯¹åº”çš„ç±»å‹

### ä½¿ç”¨

```ts
// tupleå…ƒç»„: å¤šç§å…ƒç´ çš„ç»„åˆ
// "why" 18 1.88

// 1.æ•°ç»„çš„å¼Šç«¯
// const info: any[] = ["why", 18, 1.88]
// const infoObj = {
//   name: "why",
//   age: 18,
//   height: 1.88
// }

// const name = info[0]
// console.log(name.length)


// 2.å…ƒç»„çš„ç‰¹ç‚¹
const info: [string, number, number] = ["why", 18, 1.88]
const name = info[0]
console.log(name.length)
// const age = info[1]
// console.log(age.length)

export {}
```





### åº”ç”¨åœºæ™¯ ğŸ”¥

å¯ä»¥ç›´æ¥è‡ªå®šä¹‰åˆ«åï¼

```ts
// hook: useState
// const [counter, setCounter] = {counter: , setCounter:}

function useState(state: any) {
  let currentState = state
  const changeState = (newState: any) => {
    currentState = newState
  }

  const tuple: [any, (newState: any) => void] = [currentState, changeState]
  return tuple
}

const [counter, setCounter] = useState(10);
setCounter(1000)

const [title, setTitle] = useState("abc")

export {}
```



### åº”ç”¨åœºæ™¯(ä¼˜åŒ–) ğŸ”¥

```ts
// hook: useState
// const [counter, setCounter] = {counter: , setCounter:}

function useState<T>(state: T) {
  let currentState = state
  const changeState = (newState: T) => {
    currentState = newState
  }
  const info: [string, number] = ["abc", 18]
  const tuple: [T, (newState: T) => void] = [currentState, changeState]
  return tuple
}

const [counter, setCounter] = useState(10);
setCounter(1000)
const [title, setTitle] = useState("abc")
const [flag, setFlag] = useState(true)


// type MyFunction = () => void
// const foo: MyFunction = () => {}
```





## å‡½æ•°çš„å‚æ•°å’Œè¿”å›å€¼ç±»å‹

```ts
// ç»™å‚æ•°åŠ ä¸Šç±»å‹æ³¨è§£: num1: number, num2: number
// ç»™è¿”å›å€¼åŠ ä¸Šç±»å‹æ³¨é‡Š: (): number
// åœ¨å¼€å‘ä¸­,é€šå¸¸æƒ…å†µä¸‹å¯ä»¥ä¸å†™è¿”å›å€¼çš„ç±»å‹(è‡ªåŠ¨æ¨å¯¼)
function sum(num1: number, num2: number) {
  return num1 + num2
}

// sum(123, 321)
```

å°è£…ä¸‰æ–¹åº“æ—¶ï¼Œå¯ä»¥å†™ä¸Šï¼Œæ–¹ä¾¿è°ƒç”¨æ–¹çœ‹åˆ°



## åŒ¿åå‡½æ•°çš„å‚æ•°ç±»å‹

```ts
// é€šå¸¸æƒ…å†µä¸‹, åœ¨å®šä¹‰ä¸€ä¸ªå‡½æ•°æ—¶, éƒ½ä¼šç»™å‚æ•°åŠ ä¸Šç±»å‹æ³¨è§£çš„
function foo(message: string) {

}

const names = ["abc", "cba", "nba"]
// itemæ ¹æ®ä¸Šä¸‹æ–‡çš„ç¯å¢ƒæ¨å¯¼å‡ºæ¥çš„, è¿™ä¸ªæ—¶å€™å¯ä»¥ä¸æ·»åŠ çš„ç±»å‹æ³¨è§£
// ä¸Šä¸‹æ–‡ä¸­çš„å‡½æ•°: å¯ä»¥ä¸æ·»åŠ ç±»å‹æ³¨è§£
names.forEach(function(item) {
  console.log(item.split(""))
})
```



## å¯¹è±¡ç±»å‹

```ts
// Point: x/y -> å¯¹è±¡ç±»å‹
// {x: number, y: number}
function printPoint(point: {x: number, y: number}) {
  console.log(point.x);
  console.log(point.y)
}

printPoint({x: 123, y: 321})

export {}
```



## å¯é€‰ç±»å‹ `?`

```ts
// Point: x/y/z -> å¯¹è±¡ç±»å‹
// {x: number, y: number, z?: number}
function printPoint(point: {x: number, y: number, z?: number}) {
  console.log(point.x)
  console.log(point.y)
  console.log(point.z)
}

printPoint({x: 123, y: 321})
printPoint({x: 123, y: 321, z: 111})

export {}
```





## è”åˆç±»å‹ `|`

```ts
// number|string è”åˆç±»å‹
function printID(id: number|string|boolean) {
  // ä½¿ç”¨è”åˆç±»å‹çš„å€¼æ—¶, éœ€è¦ç‰¹åˆ«çš„å°å¿ƒ
  // narrow: ç¼©å°
  if (typeof id === 'string') {
    // TypeScriptå¸®åŠ©ç¡®å®šidä¸€å®šæ˜¯stringç±»å‹
    console.log(id.toUpperCase())
  } else {
    console.log(id)
  }
}

printID(123)
printID("abc")
printID(true)
```





### å¯é€‰ç±»å‹å’Œè”åˆç±»å‹çš„å…³ç³»

```ts
// è®©ä¸€ä¸ªå‚æ•°æœ¬èº«æ˜¯å¯é€‰çš„
// ä¸€ä¸ªå‚æ•°ä¸€ä¸ªå¯é€‰ç±»å‹çš„æ—¶å€™, å®ƒå…¶å®ç±»ä¼¼äºæ˜¯è¿™ä¸ªå‚æ•°æ˜¯ ç±»å‹|undefined çš„è”åˆç±»å‹
// function foo(message?: string) {
//   console.log(message)
// }

function foo(message?: string) {
  console.log(message)
}

foo()
```





### ç±»å‹åˆ«å ğŸ”¥

```ts
// typeç”¨äºå®šä¹‰ç±»å‹åˆ«å(type alias)
type IDType = string | number | boolean
type PointType = {
  x: number
  y: number
  z?: number
}

function printId(id: IDType) {

}

function printPoint(point: PointType) {
  
}
```







## ç±»å‹æ–­è¨€ `as`

æœ‰æ—¶å€™TypeScriptæ— æ³•è·å–å…·ä½“çš„ç±»å‹ä¿¡æ¯ï¼Œè¿™ä¸ªæˆ‘ä»¬éœ€è¦ä½¿ç”¨ç±»å‹æ–­è¨€(Type Assertions)ã€‚

æ¯”å¦‚æˆ‘ä»¬é€šè¿‡ document.getElementByIdï¼ŒTypeScriptåªçŸ¥é“è¯¥å‡½æ•°ä¼šè¿”å› HTMLElement ï¼Œä½†å¹¶ä¸çŸ¥é“å®ƒå…·ä½“çš„ç±»å‹:

TypeScriptåªå…è®¸ç±»å‹æ–­è¨€è½¬æ¢ä¸º **æ›´å…·ä½“ï¼ˆçˆ¶è½¬å­ï¼‰** æˆ–è€… **ä¸å¤ªå…·ä½“ï¼ˆunknownï¼‰** çš„ç±»å‹ç‰ˆæœ¬ï¼Œæ­¤è§„åˆ™å¯é˜²æ­¢ä¸å¯èƒ½çš„å¼ºåˆ¶è½¬æ¢

```ts
// <img id="why"/>

// 1.ç±»å‹æ–­è¨€ as
const el = document.getElementById("why") as HTMLImageElement
el.src = "urlåœ°å€"


// 2.å¦å¤–æ¡ˆä¾‹: Personæ˜¯Studentçš„çˆ¶ç±»
class Person {

}

class Student extends Person {
  studying() {

  }
}

function sayHello(p: Person) {
  (p as Student).studying()
}

const stu = new Student()
sayHello(stu)


// 3.äº†è§£: as any/unknown
const message = "Hello World"
// const num: number = (message as unknown) as number
```



## éç©ºç±»å‹æ–­è¨€ `!.`

å½“æˆ‘ä»¬ç¼–å†™ä¸‹é¢çš„ä»£ç æ—¶ï¼Œåœ¨æ‰§è¡Œtsçš„ç¼–è¯‘é˜¶æ®µä¼šæŠ¥é”™ã€‚è¿™æ˜¯å› ä¸ºä¼ å…¥çš„messageæœ‰å¯èƒ½æ˜¯ä¸ºundefinedçš„ï¼Œè¿™ä¸ªæ—¶å€™æ˜¯ä¸èƒ½æ‰§è¡Œæ–¹æ³•çš„ã€‚

ä½†æ˜¯ï¼Œæˆ‘ä»¬**ç¡®å®š**ä¼ å…¥çš„å‚æ•°æ˜¯**æœ‰å€¼**çš„ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥**ä½¿ç”¨éç©ºç±»å‹æ–­è¨€**

éç©ºæ–­è¨€ä½¿ç”¨çš„æ˜¯`!` ï¼Œè¡¨ç¤ºå¯ä»¥**ç¡®å®šæŸä¸ªæ ‡è¯†ç¬¦æ˜¯æœ‰å€¼çš„**ï¼Œ**è·³è¿‡tsåœ¨ç¼–è¯‘é˜¶æ®µå¯¹å®ƒçš„æ£€æµ‹**

```ts
// message? -> undefined | string
function printMessageLength(message?: string) {
  // if (message) {
  //   console.log(message.length)
  // }
  // vue3æºç 
  console.log(message!.length)
}

printMessageLength("aaaa")
printMessageLength("hello world")
```



## å¯é€‰é“¾çš„ä½¿ç”¨ `?.`

å¯é€‰é“¾äº‹å®ä¸Šå¹¶ä¸æ˜¯TypeScriptç‹¬æœ‰çš„ç‰¹æ€§ï¼Œå®ƒæ˜¯ES11(ES2020)ä¸­å¢åŠ çš„ç‰¹æ€§: 

* å¯é€‰é“¾ä½¿ç”¨å¯é€‰é“¾æ“ä½œç¬¦ `?.`
* å®ƒçš„ä½œç”¨æ˜¯å½“å¯¹è±¡çš„å±æ€§ä¸å­˜åœ¨æ—¶ï¼Œä¼š**çŸ­è·¯**ï¼Œ**ç›´æ¥è¿”å›undefined**ï¼Œå¦‚æœå­˜åœ¨ï¼Œé‚£ä¹ˆæ‰ä¼šç»§ç»­æ‰§è¡Œ; 
* è™½ç„¶å¯é€‰é“¾æ“ä½œæ˜¯ECMAScriptæå‡ºçš„ç‰¹æ€§ï¼Œä½†æ˜¯å’ŒTypeScriptä¸€èµ·ä½¿ç”¨æ›´ç‰ˆæœ¬;

```ts
type Person = {
  name: string
  friend?: {
    name: string
    age?: number,
    girlFriend?: {
      name: string
    }
  }
}

const info: Person = {
  name: "why",
  friend: {
    name: "kobe",
    girlFriend: {
      name: "lily"
    }
  }
}


// å¦å¤–ä¸€ä¸ªæ–‡ä»¶ä¸­
console.log(info.name)
// console.log(info.friend!.name)
console.log(info.friend?.name)
console.log(info.friend?.age)
console.log(info.friend?.girlFriend?.name)



// if (info.friend) {
//   console.log(info.friend.name)

//   if (info.friend.age) {
//     console.log(info.friend.age)
//   }
// }
```





## `!!`è¿ç®—ç¬¦â€”booleanè½¬æ¢

å°†ä¸€ä¸ªå…¶ä»–ç±»å‹**è½¬æ¢æˆbooleanç±»å‹**ï¼Œç±»ä¼¼äºBoolean(å˜é‡)çš„æ–¹å¼ï¼Œæ˜¯**ES11å¢åŠ **çš„æ–°ç‰¹æ€§

```ts
const message = "Hello World"

// const flag = Boolean(message)
// console.log(flag)

const flag = !!message
console.log(flag)
```



## `??`è¿ç®—ç¬¦â€”ç©ºå€¼åˆå¹¶æ“ä½œç¬¦

**ç©ºå€¼åˆå¹¶æ“ä½œç¬¦**(**??)æ˜¯ä¸€ä¸ªé€»è¾‘æ“ä½œç¬¦ï¼Œå½“æ“ä½œç¬¦çš„å·¦ä¾§æ˜¯ null æˆ–è€… undefined æ—¶ï¼Œè¿”å›å…¶å³ä¾§æ“ä½œæ•°ï¼Œ å¦åˆ™è¿”å›å·¦ä¾§æ“ä½œæ•°**

```ts
let message: string|null = "Hello World"

const content = message ?? "ä½ å¥½å•Š, æé“¶æ²³"
// const content = message ? message: "ä½ å¥½å•Š, æé“¶æ²³"
console.log(content)
```





## å­—é¢é‡ç±»å‹â€”ç»“åˆè”åˆç±»å‹

```ts
// "Hello World"ä¹Ÿæ˜¯å¯ä»¥ä½œä¸ºç±»å‹çš„, å«åšå­—é¢é‡ç±»å‹
const message: "Hello World" = "Hello World"

// let num: 123 = 123
// num = 321


// å­—é¢é‡ç±»å‹çš„æ„ä¹‰, å°±æ˜¯å¿…é¡»ç»“åˆè”åˆç±»å‹
type Alignment = 'left' | 'right' | 'center'

let align: Alignment = 'left'
align = 'right'
align = 'center'

// align = 'hehehehe'
```





### å­—é¢é‡æ¨ç†

```ts
// const info = {
//   name: "why",
//   age: 18
// }

// info.name = "kobe"

// 

type Method = 'GET' | 'POST'
function request(url: string, method: Method) {}

type Request = {
  url: string,
  method: Method
}

const options = {
  url: "https://www.coderwhy.org/abc",
  method: "POST"
} as const

request(options.url, options.method)

export {}
```



## ç±»å‹ç¼©å° ğŸ”¥

ä»€ä¹ˆæ˜¯ç±»å‹ç¼©å°å‘¢?

* ç±»å‹ç¼©å°çš„è‹±æ–‡æ˜¯ Type Narrowing;
* æˆ‘ä»¬å¯ä»¥é€šè¿‡ç±»ä¼¼äº typeof padding === "number" çš„åˆ¤æ–­è¯­å¥ï¼Œæ¥æ”¹å˜TypeScriptçš„æ‰§è¡Œè·¯å¾„; 
* åœ¨ç»™å®šçš„æ‰§è¡Œè·¯å¾„ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç¼©å°æ¯”å£°æ˜æ—¶æ›´å°çš„ç±»å‹ï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¹‹ä¸º ç¼©å°;
* è€Œæˆ‘ä»¬ç¼–å†™çš„ typeof padding === "number å¯ä»¥ç§°ä¹‹ä¸º ç±»å‹ä¿æŠ¤(type guards);

å¸¸è§çš„ç±»å‹ä¿æŠ¤æœ‰å¦‚ä¸‹å‡ ç§: 

* typeof
* å¹³ç­‰ç¼©å°(æ¯”å¦‚`===`ã€`!==`) 
* instanceof
* in
* ç­‰ç­‰...

```ts
// 1.typeofçš„ç±»å‹ç¼©å°
type IDType = number | string
function printID(id: IDType) {
  if (typeof id === 'string') {
    console.log(id.toUpperCase())
  } else {
    console.log(id)
  }
}

// 2.å¹³ç­‰çš„ç±»å‹ç¼©å°(=== == !== !=/switch)
type Direction = "left" | "right" | "top" | "bottom"
function printDirection(direction: Direction) {
  // 1.ifåˆ¤æ–­
  // if (direction === 'left') {
  //   console.log(direction)
  // } else if ()

  // 2.switchåˆ¤æ–­
  // switch (direction) {
  //   case 'left':
  //     console.log(direction)
  //     break;
  //   case ...
  // }
}

// 3.instanceof
function printTime(time: string | Date) {
  if (time instanceof Date) {
    console.log(time.toUTCString())
  } else {
    console.log(time)
  }
}

class Student {
  studying() {}
}

class Teacher {
  teaching() {}
}

function work(p: Student | Teacher) {
  if (p instanceof Student) {
    p.studying()
  } else {
    p.teaching()
  }
}

const stu = new Student()
work(stu)

// 4. in
type Fish = {
  swimming: () => void
}

type Dog = {
  running: () => void
}

function walk(animal: Fish | Dog) {
  if ('swimming' in animal) {
    animal.swimming()
  } else {
    animal.running()
  }
}

const fish: Fish = {
  swimming() {
    console.log("swimming")
  }
}

walk(fish)
```

